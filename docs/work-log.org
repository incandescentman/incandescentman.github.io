#+TITLE: Incandescentman Work Log
#+AUTHOR: AI Assistant
#+DESCRIPTION: Daily tracking of work completed on event invitation templates

* 2025-11-13 Thursday - Event Invitation Template Refactoring

** Session Overview
Refactored event invitation template to use org-mode macros for easy reuse

** Work Completed
*** Template Analysis
- Examined existing invitation template at invite-canonical/
- Reviewed index.org (org-mode source) and index.html (generated output)
- Analyzed parallax design, calendar integration, audio autoplay, and social metadata

*** Template Improvements Suggested
- Performance: lazy loading, image optimization, preconnect hints
- Accessibility: proper title tags, remove audio autoplay, color contrast fixes
- Mobile responsiveness: fix broken CSS that hides content below 750px
- Modern CSS: remove vendor prefixes, use CSS custom properties
- Security: HTTPS links, rel="noopener noreferrer" on external links
- Calendar integration: modernize from 2018 implementation

*** Macro Implementation
Converted hardcoded event details to reusable macros (lines 8-32 of index.org):
- Event titles and headings (5 parallax sections)
- Invitation text (greeting, body, closing, signature)
- Date/time (human-readable + ISO format for calendars)
- Location details (full address + short version)
- Map URL, RSVP email, audio file
- Calendar description and social media metadata

*** Additional Improvements
- Updated HTTP → HTTPS for external links
- Added rel="noopener noreferrer" to calendar links for security
- Removed audio autoplay initially, then restored per user request
- Cleaned up HTML structure with clear section comments
- Made template ready for easy event creation

** Files Modified
- /Users/jay/Dropbox/github/incandescentman/invite-canonical/index.org (complete rewrite with macros)

** Impact
Template is now fully parameterized. To create a new invitation, user only needs to edit the macro definitions at the top (lines 8-32). Everything else updates automatically through the `{{{macro-name}}}` syntax.

** Example Usage
New event invitation can be created by changing just these lines:
```org
#+MACRO: event-title Summer Soirée
#+MACRO: event-date Saturday, June 21, 8:00pm
#+MACRO: event-location 456 Broadway, Brooklyn NY 11211
#+MACRO: rsvp-email jay@jaydixit.com
# ... etc
```

All calendar links, headings, social metadata, and content automatically update.

** Testing Instructions
To test the template:
1. Export org to HTML in Emacs: Open index.org and run `C-c C-e h h`
2. View locally: `open invite-canonical/index.html`
3. Or run local server: `cd invite-canonical && python3 -m http.server 8000`
   Then visit: http://localhost:8000/index.html

** Org Macro Export Problem (Barry Lyndon invite)
- Goal: reuse the same macro-driven workflow for `barry-lyndon/index.org` so all raw HTML blocks also see the macro values.
- Problem observed: plain `org-html-export-to-html` leaves `{{{event-title}}}` etc. untouched inside raw HTML and even errors out when the `[[{{{map-url}}}]]` link is parsed (`Unable to resolve link: "{{{map-url}}}"`).
- Attempted fixes:
  - Added `#+BIND: org-export-before-processing-hook ((lambda (_backend) (require 'org-macro) (org-macro-initialize-templates) (org-macro-replace-all org-macro-templates)))` inside `barry-lyndon/index.org`.
  - Added a local variables footer with `org-export-allow-bind-keywords: t` and also exported via CLI with `--eval "(setq org-export-allow-bind-keywords t)"`.
  - Tested alternative approaches (Org local variables block, `.dir-locals.el`, and a one-off Python preprocessor) but they either prompt every export or still leave the raw HTML macros unresolved.
- Current status: Emacs still stops with `org-macro-replace-all: Undefined Org macro: event-title; aborting` (when the BIND is honored) or `Unable to resolve link: "{{{map-url}}}"` (when the macros are not pre-expanded). Need a reliable Emacs-only hook or exporter setting that runs macro expansion *before* raw HTML is parsed, without depending on an external script.

* 2025-11-14 Friday - Fall Cocktails Invite Polish

** Session Overview
Iterated on `fall-cocktails/index.org` to finalize metadata, section heights, and hero readability tweaks.

** Work Completed
- Added Org metadata (title, description, keywords) so exports carry structured data.
- Matched `<main>` tags and ensured wrapper markup is valid.
- Tuned parallax heights for all three hero sections across breakpoints, including taller scroll reveals for sections 1–3.
- Introduced and refined a translucent overlay for the top hero heading, stretching edge-to-edge with zero padding, and positioned the heading flush with the top.
- Removed redundant down-arrow headings and hid the default Org-generated `h1.title`.
- Ensured the invite-specific CSS changes live inside the Org export (min-heights, containers, etc.).

** Files Modified
- `fall-cocktails/index.org` (multiple commits refining metadata, layout, and overlay)
- `fall-cocktails/index.html` (needs regeneration after export)

** Next Steps
- Re-export `fall-cocktails/index.org` to refresh the HTML artifact.
- Review other invites (`invite-canonical/`, `barry-lyndon/`) for similar metadata and accessibility improvements.
