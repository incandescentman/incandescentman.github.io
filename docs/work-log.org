#+TITLE: Incandescentman Work Log
#+AUTHOR: AI Assistant
#+DESCRIPTION: Daily tracking of work completed on event invitation templates

* 2025-11-13 Thursday - Event Invitation Template Refactoring

** Session Overview
Refactored event invitation template to use org-mode macros for easy reuse

** Work Completed
*** Template Analysis
- Examined existing invitation template at invite-canonical/
- Reviewed index.org (org-mode source) and index.html (generated output)
- Analyzed parallax design, calendar integration, audio autoplay, and social metadata

*** Template Improvements Suggested
- Performance: lazy loading, image optimization, preconnect hints
- Accessibility: proper title tags, remove audio autoplay, color contrast fixes
- Mobile responsiveness: fix broken CSS that hides content below 750px
- Modern CSS: remove vendor prefixes, use CSS custom properties
- Security: HTTPS links, rel="noopener noreferrer" on external links
- Calendar integration: modernize from 2018 implementation

*** Macro Implementation
Converted hardcoded event details to reusable macros (lines 8-32 of index.org):
- Event titles and headings (5 parallax sections)
- Invitation text (greeting, body, closing, signature)
- Date/time (human-readable + ISO format for calendars)
- Location details (full address + short version)
- Map URL, RSVP email, audio file
- Calendar description and social media metadata

*** Additional Improvements
- Updated HTTP → HTTPS for external links
- Added rel="noopener noreferrer" to calendar links for security
- Removed audio autoplay initially, then restored per user request
- Cleaned up HTML structure with clear section comments
- Made template ready for easy event creation

** Files Modified
- /Users/jay/Dropbox/github/incandescentman/invite-canonical/index.org (complete rewrite with macros)

** Impact
Template is now fully parameterized. To create a new invitation, user only needs to edit the macro definitions at the top (lines 8-32). Everything else updates automatically through the `{{{macro-name}}}` syntax.

** Example Usage
New event invitation can be created by changing just these lines:
```org
#+MACRO: event-title Summer Soirée
#+MACRO: event-date Saturday, June 21, 8:00pm
#+MACRO: event-location 456 Broadway, Brooklyn NY 11211
#+MACRO: rsvp-email jay@jaydixit.com
# ... etc
```

All calendar links, headings, social metadata, and content automatically update.

** Testing Instructions
To test the template:
1. Export org to HTML in Emacs: Open index.org and run `C-c C-e h h`
2. View locally: `open invite-canonical/index.html`
3. Or run local server: `cd invite-canonical && python3 -m http.server 8000`
   Then visit: http://localhost:8000/index.html

** Org Macro Export Problem (Barry Lyndon invite)
- Goal: reuse the same macro-driven workflow for `barry-lyndon/index.org` so all raw HTML blocks also see the macro values.
- Problem observed: plain `org-html-export-to-html` leaves `{{{event-title}}}` etc. untouched inside raw HTML and even errors out when the `[[{{{map-url}}}]]` link is parsed (`Unable to resolve link: "{{{map-url}}}"`).
- Attempted fixes:
  - Added `#+BIND: org-export-before-processing-hook ((lambda (_backend) (require 'org-macro) (org-macro-initialize-templates) (org-macro-replace-all org-macro-templates)))` inside `barry-lyndon/index.org`.
  - Added a local variables footer with `org-export-allow-bind-keywords: t` and also exported via CLI with `--eval "(setq org-export-allow-bind-keywords t)"`.
  - Tested alternative approaches (Org local variables block, `.dir-locals.el`, and a one-off Python preprocessor) but they either prompt every export or still leave the raw HTML macros unresolved.
- Current status: Emacs still stops with `org-macro-replace-all: Undefined Org macro: event-title; aborting` (when the BIND is honored) or `Unable to resolve link: "{{{map-url}}}"` (when the macros are not pre-expanded). Need a reliable Emacs-only hook or exporter setting that runs macro expansion *before* raw HTML is parsed, without depending on an external script.

* 2025-11-14 Friday - Fall Cocktails Invite Polish

** Session Overview
Iterated on `fall-cocktails/index.org` to finalize metadata, section heights, and hero readability tweaks.

** Work Completed
- Added Org metadata (title, description, keywords) so exports carry structured data.
- Matched `<main>` tags and ensured wrapper markup is valid.
- Tuned parallax heights for all three hero sections across breakpoints, including taller scroll reveals for sections 1–3.
- Introduced and refined a translucent overlay for the top hero heading, stretching edge-to-edge with zero padding, and positioned the heading flush with the top.
- Removed redundant down-arrow headings and hid the default Org-generated `h1.title`.
- Ensured the invite-specific CSS changes live inside the Org export (min-heights, containers, etc.).

** Files Modified
- `fall-cocktails/index.org` (multiple commits refining metadata, layout, and overlay)
- `fall-cocktails/index.html` (needs regeneration after export)

** Next Steps
- Re-export `fall-cocktails/index.org` to refresh the HTML artifact.
- Review other invites (`invite-canonical/`, `barry-lyndon/`) for similar metadata and accessibility improvements.

* 2025-12-18 Thursday - Song of My City Screening Invite

** Session Overview
Created new event invitation for Goodside movie night celebrating John Sears' Telluride selection.

** Work Completed
*** Initial Setup
- Duplicated `barry-lyndon/` folder to create `song-of-my-city/`
- Cleaned up legacy Barry Lyndon images and references

*** Content Updates
- Updated event details: Thursday December 18, 6:30pm
- Wrote invitation copy celebrating "our very own John Sears" and Goodside
- Described film: "Song of My City" by David C. Roberts - a cinematic montage reconstructing 1970s New York from B-roll of Taxi Driver, The Warriors, The Taking of Pelham 123
- Added The Square (Ruben Östlund, Palme d'Or winner) as double feature, later removed
- Added cocktail menu: The Editor's Cut, The Clean Cut (mocktail), The Telluride Toast, Seventeen Minutes, Neon Steam

*** Image Updates
- Replaced photo stills with custom watercolor artwork
- Hero image: watercolor rooftop/skyline with event details
- Closing image: watercolor Times Square "A Goodside Event"
- Simplified from 3 parallax sections to 2
- Removed hero heading text (redundant with image text)

*** Technical Changes
- Updated all CSS references from .jpg to .png
- Removed parallax-3 section and related CSS
- Cleaned up media queries for two-section layout
- Updated OpenGraph metadata for social sharing

** Files Modified
- `song-of-my-city/index.org` (complete customization)
- `song-of-my-city/index.html` (auto-generated)
- `song-of-my-city/img/` (new watercolor images)

** Commits (incandescentman repo)
- `d06b8b9` - Add Song of My City screening invite
- `be7d472` - Add The Square as double feature, update title
- `538df5e` - Update images and content for Song of My City screening

*** Jaydocs Integration
Deployed invite to dixit.ca via astro-monorepo/apps/jaydocs

**** Vite Plugin for Static HTML
Created custom Vite plugin in `astro.config.mjs` to handle static HTML folders in `public/`:
- Auto-resolves `index.html` for directory URLs
- Redirects `/path` to `/path/` for correct relative path resolution
- Enables standalone HTML pages to work alongside Astro routes

**** Font Integration
- Created shared font location at `jaydocs/public/fonts/`
- Garamond Premier Pro fonts available at `/fonts/` for all static pages
- Updated CSS to use absolute paths (`/fonts/...`) for portability

**** Itinerary Updates
- Added December 22 (NYC→Ottawa) and Dec 31 (Ottawa→NYC) to itinerary
- Fixed org→mdx sync issue (mdx is the source for display, org is user-editable)

** Commits (astro-monorepo)
- `70e0185` - Add Song of My City screening invite to jaydocs
- `daff9a0` - Add domain (dixit.ca) to jaydocs CLAUDE.md
- `4807f2a` - Add public folder index.html resolution + December itinerary
- `2b4c075` - Add Garamond fonts for song-of-my-city invite
- `b9bfe08` - Move fonts to shared jaydocs/public/fonts/ location

*** Later Addition: The Square Image
- Added The Square movie poster as third parallax section at bottom of invite
- Image: `img/the-square.jpg` (famous dinner scene with Terry Notary)
- Added CSS for parallax-3 with responsive heights

*** Org-Mode Content Conversion
- Converted HTML content section to native org-mode for easier editing
- Body paragraphs now use org syntax: `/italics/`, `*bold*`, `---` em-dash, `\\` line breaks
- Where/When details use org links: `[[url][text]]`
- Cocktail Menu uses `** Heading` org heading
- Added CSS to style org's `.outline-2` wrapper divs like details boxes
- Fixed cocktail menu width with negative margins to match container width
- Updated party-event-protocol.org with org-mode editing documentation

*** Smart Quotes Fix
- *Critical learning:* Content inside `#+BEGIN_EXPORT HTML` blocks is passed through verbatim—no org processing (including smart quotes)
- Text must be *outside* HTML export blocks to get smart quote conversion
- Added `#+OPTIONS: ':t` to enable smart quotes

*** Consolidation to Jaydocs
- Deleted `incandescentman/song-of-my-city/` folder
- Canonical location is now `astro-monorepo/apps/jaydocs/public/song-of-my-city/`
- Updated party-event-protocol.org with canonical location

** Live URL
https://dixit.ca/song-of-my-city/

** Handoff: Creating Future Event Invitations

*** Source Files
- Edit `index.org` only (not `index.html` — it's auto-generated)
- After editing org, regenerate HTML via Emacs export or copy updated HTML

*** Deploying to dixit.ca
1. Copy invitation folder to `astro-monorepo/apps/jaydocs/public/`
2. Update all meta tags to use `dixit.ca` domain (not jaydixit.com):
   - `og:image` → `https://dixit.ca/[folder]/og.png`
   - `og:url` → `https://dixit.ca/[folder]/`
3. Fonts: use absolute path `/fonts/` (shared fonts at `jaydocs/public/fonts/`)

*** OG Image
- Create fresh `og.png` for each event (don't reuse old ones)
- Use one of the event's hero images
- Recommended size: 1200x630 or similar wide aspect ratio

*** Parallax Images
- Aspect ratio: 16:9 or wider (~1.89:1 ideal)
- Resolution: 1920px+ wide (2560px for retina)
- Use `background-size: cover` — images crop from edges, keep subject centered

*** Image File Naming
- Use descriptive names: `event-name-1.png`, `event-name-2.png`
- Update CSS references in `index.org` to match new filenames

*** Testing
- Local: `npm run dev` in jaydocs, visit `http://localhost:4321/[folder]/`
- OG image: use https://www.opengraph.xyz or Facebook Debugger
- After deploy: wait 1-2 min for Vercel, then test with trailing slash
